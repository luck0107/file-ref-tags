# File Ref Tags - JetBrains IDE 代码引用管理插件

[English Documentation](README.md)

## 功能介绍

File Ref Tags 是一个 JetBrains IDE 插件，用于管理和快速访问代码引用。它允许用户将文件、代码片段和注释添加到引用面板中，并通过点击快速跳转到对应的位置，提高大型项目的开发效率。

## 核心功能

- **添加当前文件**：将当前打开的文件添加到引用面板
- **添加文件+片段**：将当前文件和选中的代码片段添加到引用面板
- **添加全局片段**：将当前选中的全局唯一片段添加到引用面板
- **添加用户注释**：添加自定义注释到引用面板
- **分组管理**：将引用项组织到分组中，便于管理
  - 创建分组对引用进行分类
  - 拖拽引用项到分组中
  - 展开/折叠分组
  - 拖拽调整分组顺序
- **类型颜色区分**：不同类型的引用项显示不同颜色
  - 文件：浅黄色背景
  - 文件+片段：浅绿色背景
  - 全局片段：浅粉色背景
  - 注释：浅灰色背景
  - 分组：浅蓝色背景
- **拖拽排序**：支持拖拽调整引用项和分组顺序
- **快速跳转**：点击引用项快速跳转到对应位置
- **编辑标题**：右键点击引用项，选择编辑菜单修改标题
- **删除引用**：右键点击引用项，选择删除菜单删除引用项
- **查看存储位置**：显示引用数据的存储位置

## 安装方法

### 从 JetBrains 插件仓库安装

1. 打开您的 JetBrains IDE（IntelliJ IDEA、WebStorm、PyCharm 等）
2. 进入 **文件** → **设置**（macOS 上为 **偏好设置**）
3. 导航到 **插件**
4. 点击 **Marketplace** 标签页
5. 搜索 "File Ref Tags"
6. 点击 **安装**
7. 提示时重启 IDE

### 手动安装

1. 从发布页面下载插件 ZIP 文件
2. 进入 **文件** → **设置** → **插件**
3. 点击齿轮图标 → **从磁盘安装插件...**
4. 选择下载的 ZIP 文件
5. 重启 IDE

## 使用说明

### 1. 打开引用面板

进入 **视图** → **工具窗口** → **File Ref Tags**，或使用 IDE 工具窗口栏中的工具窗口按钮打开引用面板。

### 2. 添加引用项

#### 2.1 添加当前文件

- 打开需要添加的文件
- 右键点击编辑器，选择 **FileRefTags** → **添加当前文件到面板**
- 或使用查找操作 (`Ctrl+Shift+A` / `Cmd+Shift+A`) 搜索 "添加当前文件到面板"

#### 2.2 添加当前文件+选中的片段

- 打开文件，选中需要添加的代码片段
- 右键点击编辑器，选择 **FileRefTags** → **添加当前文件+选中的片段到面板**
- 或使用查找操作 (`Ctrl+Shift+A` / `Cmd+Shift+A`) 搜索 "添加当前文件+选中的片段到面板"

#### 2.3 添加当前选中的全局唯一片段

- 打开文件，选中需要添加的代码片段
- 右键点击编辑器，选择 **FileRefTags** → **添加当前选中的全局唯一片段到面板**
- 或使用查找操作 (`Ctrl+Shift+A` / `Cmd+Shift+A`) 搜索 "添加当前选中的全局唯一片段到面板"
- 插件会自动搜索项目，确保片段是唯一的

#### 2.4 添加用户注释

- 右键点击编辑器，选择 **FileRefTags** → **添加用户注释到面板**
- 或使用查找操作 (`Ctrl+Shift+A` / `Cmd+Shift+A`) 搜索 "添加用户注释到面板"
- 在弹出的输入框中输入注释内容，点击确定

### 3. 管理引用项

#### 3.1 编辑引用项标题

- 在引用面板中右键点击引用项
- 选择 **编辑** 菜单项
- 在弹出的窗口中修改标题
- 点击 **保存** 按钮或按 `Enter` 键保存
- 点击 **取消** 按钮或按 `Escape` 键取消

#### 3.2 删除引用项

- 在引用面板中右键点击引用项
- 选择 **删除** 菜单项
- 引用项将被删除

#### 3.3 拖拽排序

- 点击并拖拽引用项到目标位置
- 释放鼠标，引用项将被移动到新位置
- 可以将引用项拖拽到分组上，将其添加到该分组
- 也可以拖拽分组来调整分组顺序

#### 3.4 跳转到引用位置

- 点击引用项，插件会自动跳转到对应的文件或代码片段
- 对于文件+片段和全局片段，会自动选中对应的代码片段
- 点击分组标题可以展开或折叠分组

#### 3.5 分组管理

##### 3.5.1 添加分组

- 点击引用面板工具栏中的 **Add Group** 按钮
- 在弹出的对话框中输入分组名称
- 点击 **确定** 创建分组

##### 3.5.2 将引用项添加到分组

- 拖拽引用项到分组标题上，即可将其添加到该分组
- 拖拽引用项到空白区域，可以将其从分组中移除

##### 3.5.3 展开/折叠分组

- 点击分组标题可以展开或折叠分组
- 折叠的分组显示 "▶" 图标，展开的分组显示 "▼" 图标

##### 3.5.4 调整分组顺序

- 拖拽分组标题可以调整分组顺序
- 顺序会自动保存

#### 3.6 查看存储位置

- 点击引用面板工具栏中的 **Show Storage Location** 按钮
- 插件会在文件资源管理器中打开存储引用数据的 JSON 文件

## 数据存储

插件采用多项目存储架构，每个项目拥有独立的引用数据：

### 存储结构

```
~/.file-ref-tags/
├── projects.json          # 项目路径到文件夹的映射
├── <hash1>/              # 项目1的存储文件夹（项目路径的MD5哈希值）
│   └── references.json   # 项目1的引用数据
├── <hash2>/              # 项目2的存储文件夹
│   └── references.json   # 项目2的引用数据
└── default/              # 无路径项目的默认文件夹
    └── references.json
```

### 存储位置

- **基础目录**：
  - **Windows**: `%USERPROFILE%\.file-ref-tags\`
  - **macOS/Linux**: `~/.file-ref-tags/`

- **项目映射**：`projects.json` 存储项目路径与其存储文件夹的映射关系
- **项目数据**：每个项目的 `references.json` 存储在其独立的文件夹中（通过项目路径的MD5哈希值标识）

### 优势

- **数据隔离**：每个项目拥有独立的引用数据，避免冲突
- **自动管理**：插件自动创建和管理项目文件夹
- **路径规范化**：项目路径会被规范化（不区分大小写，统一分隔符），确保跨平台兼容性

可以通过工具窗口工具栏中的 "Show Storage Location" 按钮查看当前项目的存储位置。

## 技术特点

- **轻量高效**：占用资源少，响应速度快
- **易于使用**：操作简单，上手容易
- **视觉清晰**：不同类型引用项颜色区分，一目了然
- **空间高效**：紧凑的布局设计，最大化显示空间
- **功能全面**：支持多种引用类型和操作方式

## 系统要求

- **IntelliJ 平台版本**：2023.1 或更高版本
- **支持的 IDE**：IntelliJ IDEA、WebStorm、PyCharm、PhpStorm、RubyMine、GoLand、CLion、Rider、DataGrip 以及其他 JetBrains IDE
- **操作系统**：支持 Windows、macOS 和 Linux

## 开发

本项目基于 [IntelliJ Platform Plugin Template][gh:template] 构建。

**详细的开发文档请查看 [DEVELOPMENT_zh.md](DEVELOPMENT_zh.md)（中文）或 [DEVELOPMENT.md](DEVELOPMENT.md)（English）。**

### 快速开始

1. 克隆项目仓库
2. 使用 IntelliJ IDEA 打开项目
3. 在 **File** → **Project Structure** → **Project Settings** → **Project** 中设置 SDK 为 Java 17 或更高版本
4. 运行 `./gradlew buildPlugin` 构建插件
5. 运行 `./gradlew runIde` 在沙盒 IDE 中测试插件

## 反馈与建议

如果您在使用过程中遇到问题或有任何建议，欢迎在 GitHub 仓库提交 Issue 或 Pull Request。

## 许可证

本项目采用 [MIT License](../LICENSE) 许可证，版权归 LiRenTech 所有。

---

**Enjoy coding with File Ref Tags!**
